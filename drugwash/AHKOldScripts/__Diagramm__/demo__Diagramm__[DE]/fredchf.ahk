#NoEnv
#Include __Diagramm__.ahk

; ######################################
; hier kommt nur noch meine messreihe
; typische messreihe
; #####################################
zu_testzwecken:
; Ich habe die Darstellung etwas verkürzt
messreihe =
(
1;113,2813`n2;177,7344`n3;178,7109`n4;180,6641`n5;179,6875`n6;181,6406
7;181,6406`n8;183,5938`n9;185,5469`n10;186,5234`n11;187,5`n12;189,4531
13;191,4063`n14;195,3125`n15;199,2188`n16;202,1484`n17;206,0547`n18;208,0078
19;208,9844`n20;210,9375`n21;213,8672`n22;215,8203`n23;216,7969`n24;219,7265
25;222,6563`n26;227,5391`n27;230,4688`n28;234,375`n29;239,2578`n30;244,1406
31;247,0703`n32;250`n33;252,9297`n34;254,8828`n35;259,7656`n36;262,6953
37;264,6484`n38;270,5078`n39;271,4844`n40;273,4375`n41;274,4141`n42;279,2969
43;283,2031`n44;286,1328`n45;288,0859`n46;289,0625`n47;295,8984`n48;295,8984
49;301,7578`n50;303,7109`n51;307,6172`n52;311,5234`n53;314,4531`n54;317,3828
55;320,3125`n56;326,1719`n57;330,0781`n58;331,0547`n59;333,0078`n60;336,9141
61;338,8672`n62;340,8203`n63;343,75`n64;347,6563`n65;351,5625`n66;356,4453
67;359,375`n68;366,2109`n69;366,2109`n70;371,0938`n71;375`n72;374,0234
73;379,8828`n74;384,7656`n75;388,6719`n76;388,6719`n77;389,6484`n78;392,5781
79;395,5078`n80;396,4843`n81;399,414`n82;405,2734`n83;407,2266`n84;412,1094
85;414,0625`n86;417,9687`n87;420,8984`n88;417,9687`n89;417,9687`n90;416,9922
91;418,9453`n92;419,9219`n93;436,5235`n94;458,9843`n95;474,6094`n96;481,4453
97;487,3047`n98;488,2812`n99;500`n100;503,9063`n101;500`n102;510,7422
103;507,8125`n104;513,6719`n105;515,625`n106;526,3672`n107;529,2969
108;532,2266`n109;540,0391`n110;544,9219`n111;554,6875`n112;556,6406
113;558,5938`n114;567,3828`n115;568,3594`n116;576,1719`n117;578,125
118;588,8671`n119;591,7969`n120;598,6328`n121;602,5391`n122;610,3516
123;619,1406`n124;625`n125;626,9531`n126;634,7656`n127;636,7188`n128;640,6249
129;639,6484`n130;651,3672`n131;656,25`n132;662,1093`n133;660,1563`n134;666,0156
135;674,8047`n136;679,6875`n137;685,5469`n138;698,2422`n139;706,0547
140;699,2188`n141;713,8671`n142;715,8203`n143;722,6563`n144;727,5391
145;734,375`n146;739,2578`n147;744,1406`n148;751,9531`n149;757,8125
150;764,6484`n151;769,5312`n152;776,3672`n153;780,2735`n154;785,1563
155;792,9687`n156;795,8984`n157;800,7813`n158;803,7109`n159;811,5234
160;814,4531`n161;814,4531`n162;823,2422`n163;830,0781`n164;832,0313
165;833,0079`n166;841,7968`n167;849,6094`n168;856,4453`n169;858,3984
170;855,4688`n171;855,4688`n172;859,3751`n173;860,3516`n174;877,9297
175;870,1172`n176;967,7734`n177;937,5`n178;884,7656`n179;891,6015
180;881,8359`n181;898,4375`n182;895,5079`n183;894,5313`n184;897,4609
185;907,2266`n186;898,4375`n187;905,2734`n188;900,3906`n189;0`n190;0`n191;0
192;0`n193;0`n194;0`n195;0`n196;0`n197;0`n198;0`n199;0`n200;30,27344`n201;0
202;0`n203;0`n204;0`n205;0`n206;0`n207;0`n208;0`n209;0`n210;1200`n211;0
212;0`n213;0`n214;0`n215;0`n216;0`n217;0`n218;0`n219;0`n220;1150`n221;0
222;0`n223;0`n224;0`n225;0`n226;0`n227;0`n228;0`n229;0`n230;1100`n231;0
232;0`n233;0`n234;0`n235;0`n236;0`n237;0`n238;0`n239;0`n240;1050`n241;0
242;0`n243;0`n244;0`n245;0`n246;0`n247;0`n248;0`n249;0`n250;1000
)
StringReplace, messreihe, messreihe, `;, |, All
; Anzahl der Messwerte
MX := 250
; Faktor für X-Achse
FX := 2
; Höhe des Diagrammfeldes
DH := 360
; Höchster (H) und niedrigster (L) anzuzeigender Wert
YH := 1200
YL := 0
; Beschriftung für Y-Achse
YScaler := ""
I := 0
C := 1200
D1 := 50
D2 := DH // (C // 50)
Loop, % (DH // D2) {
   YScaler .= I . (Mod(C, 100) ? ";;|" : ";R;" . C . "|")
   C -= D1
   I += D2
}
StringTrimRight, YScaler, YScaler, 1
; Beschriftung für Y-Achse
XScaler := ""
I := 0
D := 10
Loop, % (MX // D) {
   I += 10
   XScaler .= I . (Mod(I, 50) ? ";;|" : ";C;" . I . "|")
}
StringTrimRight, XScaler, XScaler, 1
; Ränder
XM := 10
YM := 10
; Los geht's
Gui, +ToolWindow
Gui, Margin, %XM%, %YM%
Gui, Font, s10, Tahoma
Gui, Add, Text, h20 Center 0x200 vÜberschrift
; Diagrammposition
DX := XM
DY := 40
RC := __Diagramm__( 1, DX, DY, messreihe, DH, YH, YL, YScaler, MX, FX, XScaler
                  , 0, 0, 0, 0, 0, 2 )
If Not RC {
   MsgBox, Fehler beim Aufruf der Funktion __Diagramm__()
   ExitApp
}
DW := DH := 0
If RegExMatch(RC, "^(?P<W>\d+)\|(?P<H>\d+)$", D) {
   X := XM
   Y := YM + DH + YM - 1
   GuiControl, Move, Überschrift, w%DW% h20
   Gui, Font, s12
   GuiControl, Font, Überschrift
   GuiControl, , Überschrift
      , Breite Diagrammbereich : %DW% Pixel - Höhe Diagrammbereich : %DH% Pixel
   Gui, Font, s10
   X := DX
   Y := DY + DH + YM
   W := DW // 100 * 25
   Gui, Add, Button, x%X% y%Y% w%W%, Aktion 1
   X := DX + (DW // 2) - (W // 2)
   Gui, Add, Button, x%X% yp wp, Aktion 2
   X := DX + DW - W
   Gui, Add, Button, x%X% yp wp, Aktion 3
}

Gui, Show, AutoSize , % "    Messreihe vom " . A_DD . "." . A_MM . "." A_YYYY
Return
; ------------------------------------------------------------------------------
GuiCLose:
GuiEscape:
ExitApp
